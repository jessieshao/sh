<title>首页</title>
<h5>账户余额：<span id = "amount">&&&amount&&&</span> </h5>
<button id="button">打钱</button>
<script>
    button.addEventListener('click',(e)=>{
        let script = document.createElement('script')
        let functionName = 'jessie'+parseInt(Math.random()*10000,10)
        window[functionName] = function(result){
            if(result === 'success'){
                console.log('success')
                amount.innerText = amount.innerText - 1
            }else{}
        }

        script.src = 'http://jack.com:8887/pay?callback=' + functionName
        document.body.appendChild(script)
        script.onload = function(e){
            e.currentTarget.remove()
            delete window[functionName]
        }
        script.onerror = function(){
            e.currentTarget.remove()
            alert('fail')
            delete window[functionName]
        }
    })
</script>

